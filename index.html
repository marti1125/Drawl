<!DOCTYPE html>
<html>
<!-- 
    Exchange the line above for this to enable offline support
    <html manifest="manifest.appcache">

    Please make your homework before doing this:
        http://www.alistapart.com/articles/application-cache-is-a-douchebag/
        http://appcachefacts.info
    
    This might be necessary to set up on your server, to make sure 
    files are updated when the appcache file itself is:
        https://github.com/robnyman/Firefox-OS-Boilerplate-App/blob/gh-pages/.htaccess
 -->
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale = 1.0,maximum-scale = 1.0" />
    <link rel="stylesheet" type="text/css" href="css/base.css">
    <!-- <link rel="stylesheet" type="text/css" href="css/headers.css"> -->
    <!-- <link rel="stylesheet" type="text/css" href="css/buttons.css"> -->
    <link rel="stylesheet" type="text/css" href="css/toolbars.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/grid.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/styles.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/slider.css" rel="stylesheet">
    
    <meta name="apple-mobile-web-app-capable" content="yes" />
    
    <title>Drawl</title>
    
</head>

<body>

  <div id="container">
      <div id="top">
        <canvas id="sketchpad" width="320" height="392">
          Sorry, your browser is not supported.
        </canvas>		
      </div>
    
      <footer id="footer">
        <nav id="maintoolbar" class="navbar navbar-default navbar-fixed-bottom" role="navigation">
          <div class="col-xs-9">
            <button type="button" class="btn btn-default" id="btn-pencil">P</button>
            <button type="button" class="btn btn-default" id="btn-colorpicker">C</button>
            <button type="button" class="btn btn-default" id="btn-eraser">E</button>
            <button type="button" class="btn btn-default" id="btn-brushsize">S</button>
          </div>
          <div class="col-xs-3">
            <button type="button" class="btn btn-default pull-right" id="btn-done">Done</button>
          </div>
        </nav>
        
        <div id="done-panel" class="panel panel-default">
          <div class="panel-heading">What do you want to do?</div>
          <div class="panel-body">
            <button type="button" class="btn btn-primary btn-lg btn-block" id="btn-save">Save</button>
            <button type="button" class="btn btn-default btn-lg btn-block" id="btn-new">Clear</button>
            <button type="button" class="btn btn-default btn-lg btn-block" id="btn-cancel">Cancel</button>
          </div>
        </div>

        <div class="toolbar" id="colorpicker">
            <div class="col-xs-12">
              <button class="btn btn-default" id="color-zero">b</button>
              <button class="btn btn-default" id="color-one">r</button>
              <button class="btn btn-default" id="color-two">o</button>
              <button class="btn btn-default" id="color-three">y</button>
              <button class="btn btn-default" id="color-four">g</button>
              <button class="btn btn-default" id="color-five">b</button>
              <button class="btn btn-default" id="color-six">i</button>
              <button class="btn btn-default" id="color-seven">v</button>
            </div>
        </div>

        <div class="toolbar" id="brushsize">
            <div class="col-xs-12">
              <!-- <p>Brush size</p> -->
              <div id="brushStrokeSize" class="slider slider-horizontal" style="width: 240px;"></div>

              <!-- <p>Brush softness</p> -->
              <!-- <div id="brushSoftness" class="slider slider-horizontal" style="width: 140px;"></div> -->

              <!-- <p>Opacity</p>
              <div id="brushOpacity" class="slider slider-horizontal" style="width: 140px;"></div> -->
            </div>
        </div>
        
        
      </footer>
      
  </div> <!-- end container -->


  <script type="text/javascript" src="js/base.js"></script>
  <script type="text/javascript" src="js/webapp.js"></script>
  <script type="text/javascript" src="js/offline.js"></script>
  <script type="text/javascript" src="js/jquery-1.10.2.min.js"></script>
  <script type="text/javascript" src="js/draw.js"></script>
  <script type="text/javascript" src="js/toolbar.js"></script>
  <script type="text/javascript" src="js/bootstrap-slider.js"></script>
  <script type="text/javascript" src="js/modernizr.js"></script>
  <script type="text/javascript" src="js/jquery.hammer.min.js"></script>

  <!-- 
      Loosely based on fxosstub: https://github.com/Jaxo/fxosstub
  -->
  
  <script type="text/javascript" charset="utf-8">
  
    // detect a mobile device
    var isMobile = {
        Android: function() {
            return navigator.userAgent.match(/Android/i);
        },
        BlackBerry: function() {
            return navigator.userAgent.match(/BlackBerry/i);
        },
        iOS: function() {
            return navigator.userAgent.match(/iPhone|iPad|iPod/i);
        },
        Opera: function() {
            return navigator.userAgent.match(/Opera Mini/i);
        },
        Windows: function() {
            return navigator.userAgent.match(/IEMobile/i);
        },
        any: function() {
            return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows());
        }
    };
    
    if (isMobile.iOS()) {
      
      // scroll down nav on IOS
      // window.scrollTo(0, 1);

      if(window.navigator.standalone == false){
        // alert("installed home screen!");
        // this is the real UI here
        $("body").html("install this app!");
      } 
      
    }
    
    //this works only for iOS/Android   
    if (isMobile.any()) {
      

      
      //get current Ypos of toolbar and store it
      
      // Hammertime onRELEASE, move the toolbar back up
      var release = document.getElementById('sketchpad');
      var hammertime_release = Hammer(release).on("release", function(event) {
          $("#maintoolbar").animate({
            bottom: "0"
          }, 300);
      });

      // Hammertime onTOUCH, move the toolbar down
      var touch = document.getElementById('sketchpad');
      var hammertime_hold = Hammer(touch).on("touch", function(event) {
          // move the toolbar down
          $("#maintoolbar").animate({
            bottom: "-100"
          }, 300);
          // move the brushsize toolbar down if it's up
          if (parseInt($("#brushsize.toolbar").css("bottom")) == 64) {
            $( "#brushsize.toolbar" ).animate({
                bottom: "-200"
              }, 300);
          }
          //alert($("#brushsize.toolbar").css("bottom"))
      });

    } else {
      
      //touch events for FFOS
      canvas.addEventListener('touchstart',function(event){
        $( "#maintoolbar" ).animate({
            top: "500"
          }, 300);
      }, false);

      canvas.addEventListener('touchend',function(event){
        $( "#maintoolbar" ).animate({
            top: "396"
          }, 300);
      }, false);
      
    }

    // move toolbar up and down by tapping it
    //function moveupToolbar() { }
    //function movedownToolbar() { }
    
    // Change the Brush Softness
    
    
    // Change the Brush Opacity
    //get the alpha of the current brush and asjust it
    
    // Change the Brush Stroke
    var BrushChange = function() {
      context.lineWidth = brushStroke.getValue();
    };
    
    var brushStroke = $('#brushStrokeSize').slider({
      tooltip: "hide"
    })
                    .on('slide', BrushChange)
                    .data('slider');
    
    
  </script>

</body>
</html>
